# nova-rootwrap command filters for volume nodes
# This file should be owned by (and only-writeable by) the root user

[Filters]
# nova/volume/iscsi.py: iscsi_helper '--op' ...
ietadm: CommandFilter, /usr/sbin/ietadm, root
tgtadm: CommandFilter, /usr/sbin/tgtadm, root
tgt-admin: CommandFilter, /usr/sbin/tgt-admin, root

# nova/volume/driver.py: 'vgs', '--noheadings', '-o', 'name'
vgs: CommandFilter, /sbin/vgs, root

# nova/volume/driver.py: 'lvcreate', '-L', sizestr, '-n', volume_name,..
# nova/volume/driver.py: 'lvcreate', '-L', ...
lvcreate: CommandFilter, /sbin/lvcreate, root

# nova/volume/driver.py: 'dd', 'if=%s' % srcstr, 'of=%s' % deststr,...
dd: CommandFilter, /bin/dd, root

# nova/volume/driver.py: 'lvremove', '-f', %s/%s % ...
lvremove: CommandFilter, /sbin/lvremove, root

# nova/volume/driver.py: 'lvdisplay', '--noheading', '-C', '-o', 'Attr',..
lvdisplay: CommandFilter, /sbin/lvdisplay, root

# nova/volume/driver.py: 'iscsiadm', '-m', 'discovery', '-t',...
# nova/volume/driver.py: 'iscsiadm', '-m', 'node', '-T', ...
iscsiadm: CommandFilter, /sbin/iscsiadm, root
iscsiadm_usr: CommandFilter, /usr/bin/iscsiadm, root

#nova/volume/.py: utils.temporary_chown(path, 0), ...
chown: CommandFilter, /bin/chown, root

# nova/volume/nas_driver.py: 'mkfs.ext4', '/dev/mapper/%s'
mkfs.ext4: CommandFilter, /sbin/mkfs.ext4, root

# nova/volume/nas_driver.py: 'exportfs', ...
exportfs: CommandFilter, /usr/sbin/exportfs, root

# nova/volume/nas_driver.py: 'smbd', '-s', '%s', '-D'
smbd: CommandFilter, /usr/sbin/smbd, root

# nova/volume/nas_driver.py: 'umount', '-f', '%s'
umount: CommandFilter, /bin/umount, root

# nova/volume/nas_driver.py: 'mount', '/dev/mapper/%s', '%s'
mount: CommandFilter, /bin/mount, root

# nova/volume/nas_driver.py: 'chmod', '777', '%s'
chmod: CommandFilter, /bin/chmod, root

# nova/volume/nas_driver.py: 'chown', 'nobody', '-R', '%s'
chown: CommandFilter, /bin/chown, root

# nova/volume/nas_driver.py: 'pkill', '-HUP', 'smbd'
pkill: CommandFilter, /usr/bin/pkill, root

# nova/volume/nas_driver.py: 'smbcontrol', 'all', 'close-share', '%s'
smbcontrol: CommandFilter, /usr/bin/smbcontrol, root
